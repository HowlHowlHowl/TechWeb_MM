<!DOCTYPE html>
<html lang="it">
<head>
	<meta charset="utf-8">
	<title>Player</title>
	<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> <!--codice boostrap per attivare le funzionalità bootstrap-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<link rel="icon" type="image/png" sizes="16x16" href="/public/images/icons/site16x16.ico">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	<script type="text/javascript">
		var next_index;
		function setBeginning(data) {
			$('h1').text('(' + data.name + ')'); // per recuperare l'h1 dal DOM (oggetto documento)
			$('#nome-attivita').text(data.activities[0].name);
			data.activities[0].contents.forEach(function (elem) {
				if (elem.type == 'text') {
					$('.testo-attivita').append(elem.text);
				}
				if (elem.type == 'video') {
					var video = document.createElement('video');
					var source = document.createElement('source');
					source.setAttribute('src', elem.url);
					video.setAttribute('width', '400');
					video.setAttribute('controls', '');
					video.appendChild(source);
					$('.video').appendChild(video);
					$('.div-grande-video').append(elem.description);
				}
				if (elem.type == 'image') {
					var image = document.createElement('img');
					image.setAttribute('src', elem.url);
					image.setAttribute('alt', elem.description);
					image.setAttribute('width', '400');
					$('.div-grande-img').append(elem.description);
					$('.img').append(image);
                }
			});
			next_index=data.activities[0].input.next_index;
		}
		$('#bottone-avanti').on('click', function () {

		});
		function setPlayer(data) {
			$.ajax({
				url: '/players'
				success:
			});
        }
		$(document).ready(function () {
			// richiesta storia
            var url_string = window.location.href;
            var url = new URL(url_string);
            var id = url.searchParams.get("id");
            $.ajax({
                type: 'GET',
                url: '/stories/' + id,
                success: function (data) {
					setBeginning(data);
					setPlayer(data);
                },
                error: function (xhr, ajaxOptions, thrownError) {
					alert(xhr.status + ' - ' + thrownError);
                }
            });
        });


	</script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style type="text/css">
		@font-face {
			font-family: 'All The Roll';
			src: url('public/fonts/AllTheRollPersonalUse.woff2') format('woff2'), url('public/fonts/AllTheRollPersonalUse.woff') format('woff');
			font-weight: normal;
			font-style: normal;
			font-display: swap;
		}

		h1 {
			font-size: 6vw;
			text-align: center;
			color: white;
			margin-top: 20px;
			font-family: "All The Roll";
		}

		#div-grande {
			margin: 0 7vw 0 7vw;
			border: 3px #007bff solid;
			height: 80vh;
			overflow-y: auto;
			background-color: white;
		}

		.bottonechat {
			bottom: 0;
			right: 0;
			position: fixed;
			font-size: 3vh;
			margin-right: 0.5vw;
		}
		#nome-attivita {
			text-align: center;
			font-size: 2vw;
			font-family: 'Helvetica Neue LT Std';
		}
        .testo-attivita {
            width: 50%;
            float: left;
            margin-left: 15px;
            margin-top: 1px;
            font-size: 2.5vh;
            text-align: justify;
            font-family: 'Helvetica Neue LT Std';
        }

		body {
			background-color: #007bff;
		}
	</style>
</head>
<body >

    <div id="generico">
        <button type="button" id="chat-button" class="btn btn-light bottonechat">Chat</button>
    </div>
    <h1></h1>
	<div id="div-grande">

		<!--TITOLO MISSIONE-->
		<div id="nome-missione">
		</div>
		<div id="nome-attivita">
			<button id="bottone-avanti" type="button" class="btn btn-primary">Avanti</button>
		</div>
		<!--TESTO ATTIVITA VISUALIZZATA-->
		<div class="testo-attivita">
		</div>

		<!--SPAZIO VIDEO-->
		<div class="div-grande-video">
			<div class="video">
			</div>
		</div>
		<!--SPAZIO IMMAGINE-->
		<div class="div-grande-img">
			<div class="img"></div>
		</div>
	</div>
   
</body>
</html>